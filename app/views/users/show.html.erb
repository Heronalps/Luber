<% provide(:title, 'My Account') %>
<% provide(:path, @view_renderer.lookup_context.find_template(@virtual_path).identifier.to_s) %>

<section class="container-fluid" id="profile-header">
  <div class="container">
    <div class="row">
      <div class="col-1">
        <%= gravatar_for @user %>
      </div>
      <div class="col" id="header-info">
        <h1><%= @user.name %></h1>
        <p class="lead">A member since <%= @user.created_at.strftime("%B %e, %Y") %></p>
      </div>
    </div>
  </div>
</section>
<section class="container-fluid" id="profile-nav">
  <nav class="container">
    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a class="nav-link active" href="#">Overview</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">My Rentals</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">My Cars</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">History</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Settings</a>
      </li>
    </ul>
  </nav>
</section>

<% if session[:user_id] == @user.id %>

  <h1>
      My cars
  </h1>    

  <table>
    <thead>
      <tr>
        <th>User</th>
        <th>Plate num</th>
        <th>Model</th>
        <th>Color</th>
        <th>Year</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @my_cars.each do |car| %>
        <tr>
          <td><%= car.user_id %></td>
          <td><%= car.plate_num %></td>
          <td><%= car.model %></td>
          <td><%= car.color %></td>
          <td><%= car.year %></td>
          <td><%= link_to 'Show', car %></td>
          <td><%= link_to 'Edit', edit_car_path(car) %></td>
          <td><%= link_to 'Destroy', car, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <%= link_to( 'Add car', new_car_path) %>

  <h1>
    Rides I sold
  </h1>    

  <table>
    <thead>
      <tr>
        <th>Car</th>
        <th>Owner</th>
        <th>Renter</th>
        <th>Start location</th>
        <th>End location</th>
        <th>Start time</th>
        <th>End time</th>
        <th>Price</th>
        <th colspan="3">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @rides_sold.each do |rental_post| %>
        <tr>
          <td><%= rental_post.car_id %></td>
          <td><%= rental_post.owner_id %></td>
          <td><%= rental_post.renter_id %></td>
          <td><%= rental_post.start_location %></td>
          <td><%= rental_post.end_location %></td>
          <td><%= rental_post.start_time %></td>
          <td><%= rental_post.end_time %></td>
          <td><%= rental_post.price %></td>
          <td><%= link_to 'Show', rental_post %></td>
          <td><%= link_to 'Edit', edit_rental_post_path(rental_post) %></td>
          <td><%= link_to 'Destroy', rental_post, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

    <h1>
        Rides I ordered 
    </h1>    

    <table>
      <thead>
        <tr>
          <th>Car</th>
          <th>Owner</th>
          <th>Renter</th>
          <th>Start location</th>
          <th>End location</th>
          <th>Start time</th>
          <th>End time</th>
          <th>Price</th>
          <th colspan="3">Actions</th>
        </tr>
      </thead>

      <tbody>
        <% @rides_bought.each do |rental_post| %>
          <tr>
            <td><%= rental_post.car_id %></td>
            <td><%= rental_post.owner_id %></td>
            <td><%= rental_post.renter_id %></td>
            <td><%= rental_post.start_location %></td>
            <td><%= rental_post.end_location %></td>
            <td><%= rental_post.start_time %></td>
            <td><%= rental_post.end_time %></td>
            <td><%= rental_post.price %></td>
          </tr>
        <% end %>
      </tbody>
    </table>


<% else %>
  (You are logged in as <%= User.find(session[:user_id]).name %>.)
<% end %>

